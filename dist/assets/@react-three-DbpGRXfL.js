import{r as p,j as B}from"./react-BdIgl1Fy.js";import{W as Ot,R as Tt,O as Le,P as We,S as It,a as Ce,V as _t,b as zt,B as kt,L as At,c as rt,N as Dt,A as Ft,d as Xe,C as Ht,e as Lt,U as Wt,f as Z,g as ot,h as Nt,i as Bt,T as Vt,D as qt,M as Ut}from"./three-BwhAiKv5.js";import{j as Gt}from"./react-use-measure-D5kTF-sN.js";import{c as Xt,x as $t,i as Yt,m as Zt}from"./its-fine-5xP9g-Od.js";import{c as me,R as Jt}from"./react-reconciler-DBmB3f-g.js";import{s as $e}from"./scheduler-DV1PgV85.js";import{_ as Ne}from"./@babel-CF3RwP-h.js";import{c as Kt}from"./react-dom-BBiofZzJ.js";import{c as Qt}from"./zustand-TjhRvl29.js";function it(e){let t=e.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const st=e=>e&&e.isOrthographicCamera,en=e=>e&&e.hasOwnProperty("current"),tn=e=>e!=null&&(typeof e=="string"||typeof e=="number"||e.isColor),fe=((e,t)=>typeof window<"u"&&(((e=window.document)==null?void 0:e.createElement)||((t=window.navigator)==null?void 0:t.product)==="ReactNative"))()?p.useLayoutEffect:p.useEffect;function ct(e){const t=p.useRef(e);return fe(()=>void(t.current=e),[e]),t}function nn(){const e=Xt(),t=$t();return p.useMemo(()=>({children:n})=>{const o=!!Yt(e,!0,s=>s.type===p.StrictMode)?p.StrictMode:p.Fragment;return B.jsx(o,{children:B.jsx(t,{children:n})})},[e,t])}function rn({set:e}){return fe(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}const on=(e=>(e=class extends p.Component{constructor(...n){super(...n),this.state={error:!1}}componentDidCatch(n){this.props.set(n)}render(){return this.state.error?null:this.props.children}},e.getDerivedStateFromError=()=>({error:!0}),e))();function at(e){var t;const n=typeof window<"u"?(t=window.devicePixelRatio)!=null?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}function ne(e){var t;return(t=e.__r3f)==null?void 0:t.root.getState()}const I={obj:e=>e===Object(e)&&!I.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,nul:e=>e===null,arr:e=>Array.isArray(e),equ(e,t,{arrays:n="shallow",objects:r="reference",strict:o=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(I.str(e)||I.num(e)||I.boo(e))return e===t;const s=I.obj(e);if(s&&r==="reference")return e===t;const d=I.arr(e);if(d&&n==="reference")return e===t;if((d||s)&&e===t)return!0;let u;for(u in e)if(!(u in t))return!1;if(s&&n==="shallow"&&r==="shallow"){for(u in o?t:e)if(!I.equ(e[u],t[u],{strict:o,objects:"reference"}))return!1}else for(u in o?t:e)if(e[u]!==t[u])return!1;if(I.und(u)){if(d&&e.length===0&&t.length===0||s&&Object.keys(e).length===0&&Object.keys(t).length===0)return!0;if(e!==t)return!1}return!0}};function sn(e){e.type!=="Scene"&&(e.dispose==null||e.dispose());for(const t in e){const n=e[t];(n==null?void 0:n.type)!=="Scene"&&(n==null||n.dispose==null||n.dispose())}}const lt=["children","key","ref"];function cn(e){const t={};for(const n in e)lt.includes(n)||(t[n]=e[n]);return t}function ge(e,t,n,r){const o=e;let s=o==null?void 0:o.__r3f;return s||(s={root:t,type:n,parent:null,children:[],props:cn(r),object:o,eventCount:0,handlers:{},isHidden:!1},o&&(o.__r3f=s)),s}function ue(e,t){let n=e[t];if(!t.includes("-"))return{root:e,key:t,target:n};n=e;for(const o of t.split("-")){var r;t=o,e=n,n=(r=n)==null?void 0:r[t]}return{root:e,key:t,target:n}}const Ye=/-\d+$/;function be(e,t){if(I.str(t.props.attach)){if(Ye.test(t.props.attach)){const o=t.props.attach.replace(Ye,""),{root:s,key:d}=ue(e.object,o);Array.isArray(s[d])||(s[d]=[])}const{root:n,key:r}=ue(e.object,t.props.attach);t.previousAttach=n[r],n[r]=t.object}else I.fun(t.props.attach)&&(t.previousAttach=t.props.attach(e.object,t.object))}function xe(e,t){if(I.str(t.props.attach)){const{root:n,key:r}=ue(e.object,t.props.attach),o=t.previousAttach;o===void 0?delete n[r]:n[r]=o}else t.previousAttach==null||t.previousAttach(e.object,t.object);delete t.previousAttach}const _e=[...lt,"args","dispose","attach","object","onUpdate","dispose"],Ze=new Map;function an(e){let t=Ze.get(e.constructor);try{t||(t=new e.constructor,Ze.set(e.constructor,t))}catch{}return t}function ln(e,t){const n={};for(const r in t)if(!_e.includes(r)&&!I.equ(t[r],e.props[r])){n[r]=t[r];for(const o in t)o.startsWith(`${r}-`)&&(n[o]=t[o])}for(const r in e.props){if(_e.includes(r)||t.hasOwnProperty(r))continue;const{root:o,key:s}=ue(e.object,r);if(o.constructor&&o.constructor.length===0){const d=an(o);I.und(d)||(n[s]=d[s])}else n[s]=0}return n}const un=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],fn=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function Y(e,t){var n;const r=e.__r3f,o=r&&it(r).getState(),s=r==null?void 0:r.eventCount;for(const u in t){let i=t[u];if(_e.includes(u))continue;if(r&&fn.test(u)){typeof i=="function"?r.handlers[u]=i:delete r.handlers[u],r.eventCount=Object.keys(r.handlers).length;continue}if(i===void 0)continue;let{root:v,key:c,target:l}=ue(e,u);if(l instanceof Xe&&i instanceof Xe)l.mask=i.mask;else if(l instanceof Ht&&tn(i))l.set(i);else if(l!==null&&typeof l=="object"&&typeof l.set=="function"&&typeof l.copy=="function"&&i!=null&&i.constructor&&l.constructor===i.constructor)l.copy(i);else if(l!==null&&typeof l=="object"&&typeof l.set=="function"&&Array.isArray(i))typeof l.fromArray=="function"?l.fromArray(i):l.set(...i);else if(l!==null&&typeof l=="object"&&typeof l.set=="function"&&typeof i=="number")typeof l.setScalar=="function"?l.setScalar(i):l.set(i);else{var d;v[c]=i,o&&!o.linear&&un.includes(c)&&(d=v[c])!=null&&d.isTexture&&v[c].format===Lt&&v[c].type===Wt&&(v[c].colorSpace=rt)}}if(r!=null&&r.parent&&o!=null&&o.internal&&(n=r.object)!=null&&n.isObject3D&&s!==r.eventCount){const u=r.object,i=o.internal.interaction.indexOf(u);i>-1&&o.internal.interaction.splice(i,1),r.eventCount&&u.raycast!==null&&o.internal.interaction.push(u)}return r&&r.props.attach===void 0&&(r.object.isBufferGeometry?r.props.attach="geometry":r.object.isMaterial&&(r.props.attach="material")),r&&se(r),e}function se(e){var t;if(!e.parent)return;e.props.onUpdate==null||e.props.onUpdate(e.object);const n=(t=e.root)==null||t.getState==null?void 0:t.getState();n&&n.internal.frames===0&&n.invalidate()}function dn(e,t){e.manual||(st(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix())}const L=e=>e==null?void 0:e.isObject3D;function ve(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function ut(e,t,n,r){const o=n.get(t);o&&(n.delete(t),n.size===0&&(e.delete(r),o.target.releasePointerCapture(r)))}function pn(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter(r=>r!==t),n.initialHits=n.initialHits.filter(r=>r!==t),n.hovered.forEach((r,o)=>{(r.eventObject===t||r.object===t)&&n.hovered.delete(o)}),n.capturedMap.forEach((r,o)=>{ut(n.capturedMap,t,r,o)})}function vn(e){function t(i){const{internal:v}=e.getState(),c=i.offsetX-v.initialClick[0],l=i.offsetY-v.initialClick[1];return Math.round(Math.sqrt(c*c+l*l))}function n(i){return i.filter(v=>["Move","Over","Enter","Out","Leave"].some(c=>{var l;return(l=v.__r3f)==null?void 0:l.handlers["onPointer"+c]}))}function r(i,v){const c=e.getState(),l=new Set,h=[],m=v?v(c.internal.interaction):c.internal.interaction;for(let f=0;f<m.length;f++){const a=ne(m[f]);a&&(a.raycaster.camera=void 0)}c.previousRoot||c.events.compute==null||c.events.compute(i,c);function O(f){const a=ne(f);if(!a||!a.events.enabled||a.raycaster.camera===null)return[];if(a.raycaster.camera===void 0){var w;a.events.compute==null||a.events.compute(i,a,(w=a.previousRoot)==null?void 0:w.getState()),a.raycaster.camera===void 0&&(a.raycaster.camera=null)}return a.raycaster.camera?a.raycaster.intersectObject(f,!0):[]}let z=m.flatMap(O).sort((f,a)=>{const w=ne(f.object),j=ne(a.object);return!w||!j?f.distance-a.distance:j.events.priority-w.events.priority||f.distance-a.distance}).filter(f=>{const a=ve(f);return l.has(a)?!1:(l.add(a),!0)});c.events.filter&&(z=c.events.filter(z,c));for(const f of z){let a=f.object;for(;a;){var T;(T=a.__r3f)!=null&&T.eventCount&&h.push({...f,eventObject:a}),a=a.parent}}if("pointerId"in i&&c.internal.capturedMap.has(i.pointerId))for(let f of c.internal.capturedMap.get(i.pointerId).values())l.has(ve(f.intersection))||h.push(f.intersection);return h}function o(i,v,c,l){if(i.length){const h={stopped:!1};for(const m of i){let O=ne(m.object);if(O||m.object.traverseAncestors(z=>{const T=ne(z);if(T)return O=T,!1}),O){const{raycaster:z,pointer:T,camera:f,internal:a}=O,w=new Z(T.x,T.y,0).unproject(f),j=y=>{var S,b;return(S=(b=a.capturedMap.get(y))==null?void 0:b.has(m.eventObject))!=null?S:!1},M=y=>{const S={intersection:m,target:v.target};a.capturedMap.has(y)?a.capturedMap.get(y).set(m.eventObject,S):a.capturedMap.set(y,new Map([[m.eventObject,S]])),v.target.setPointerCapture(y)},g=y=>{const S=a.capturedMap.get(y);S&&ut(a.capturedMap,m.eventObject,S,y)};let k={};for(let y in v){let S=v[y];typeof S!="function"&&(k[y]=S)}let A={...m,...k,pointer:T,intersections:i,stopped:h.stopped,delta:c,unprojectedPoint:w,ray:z.ray,camera:f,stopPropagation(){const y="pointerId"in v&&a.capturedMap.get(v.pointerId);if((!y||y.has(m.eventObject))&&(A.stopped=h.stopped=!0,a.hovered.size&&Array.from(a.hovered.values()).find(S=>S.eventObject===m.eventObject))){const S=i.slice(0,i.indexOf(m));s([...S,m])}},target:{hasPointerCapture:j,setPointerCapture:M,releasePointerCapture:g},currentTarget:{hasPointerCapture:j,setPointerCapture:M,releasePointerCapture:g},nativeEvent:v};if(l(A),h.stopped===!0)break}}}return i}function s(i){const{internal:v}=e.getState();for(const c of v.hovered.values())if(!i.length||!i.find(l=>l.object===c.object&&l.index===c.index&&l.instanceId===c.instanceId)){const h=c.eventObject.__r3f;if(v.hovered.delete(ve(c)),h!=null&&h.eventCount){const m=h.handlers,O={...c,intersections:i};m.onPointerOut==null||m.onPointerOut(O),m.onPointerLeave==null||m.onPointerLeave(O)}}}function d(i,v){for(let c=0;c<v.length;c++){const l=v[c].__r3f;l==null||l.handlers.onPointerMissed==null||l.handlers.onPointerMissed(i)}}function u(i){switch(i){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return v=>{const{internal:c}=e.getState();"pointerId"in v&&c.capturedMap.has(v.pointerId)&&requestAnimationFrame(()=>{c.capturedMap.has(v.pointerId)&&(c.capturedMap.delete(v.pointerId),s([]))})}}return function(c){const{onPointerMissed:l,internal:h}=e.getState();h.lastEvent.current=c;const m=i==="onPointerMove",O=i==="onClick"||i==="onContextMenu"||i==="onDoubleClick",T=r(c,m?n:void 0),f=O?t(c):0;i==="onPointerDown"&&(h.initialClick=[c.offsetX,c.offsetY],h.initialHits=T.map(w=>w.eventObject)),O&&!T.length&&f<=2&&(d(c,h.interaction),l&&l(c)),m&&s(T);function a(w){const j=w.eventObject,M=j.__r3f;if(!(M!=null&&M.eventCount))return;const g=M.handlers;if(m){if(g.onPointerOver||g.onPointerEnter||g.onPointerOut||g.onPointerLeave){const k=ve(w),A=h.hovered.get(k);A?A.stopped&&w.stopPropagation():(h.hovered.set(k,w),g.onPointerOver==null||g.onPointerOver(w),g.onPointerEnter==null||g.onPointerEnter(w))}g.onPointerMove==null||g.onPointerMove(w)}else{const k=g[i];k?(!O||h.initialHits.includes(j))&&(d(c,h.interaction.filter(A=>!h.initialHits.includes(A))),k(w)):O&&h.initialHits.includes(j)&&d(c,h.interaction.filter(A=>!h.initialHits.includes(A)))}}o(T,c,f,a)}}return{handlePointer:u}}const Je=e=>!!(e!=null&&e.render),ft=p.createContext(null),hn=(e,t)=>{const n=Qt((u,i)=>{const v=new Z,c=new Z,l=new Z;function h(f=i().camera,a=c,w=i().size){const{width:j,height:M,top:g,left:k}=w,A=j/M;a.isVector3?l.copy(a):l.set(...a);const y=f.getWorldPosition(v).distanceTo(l);if(st(f))return{width:j/f.zoom,height:M/f.zoom,top:g,left:k,factor:1,distance:y,aspect:A};{const S=f.fov*Math.PI/180,b=2*Math.tan(S/2)*y,U=b*(j/M);return{width:U,height:b,top:g,left:k,factor:j/U,distance:y,aspect:A}}}let m;const O=f=>u(a=>({performance:{...a.performance,current:f}})),z=new ot;return{set:u,get:i,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(f=1)=>e(i(),f),advance:(f,a)=>t(f,a,i()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Nt,pointer:z,mouse:z,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const f=i();m&&clearTimeout(m),f.performance.current!==f.performance.min&&O(f.performance.min),m=setTimeout(()=>O(i().performance.max),f.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:h},setEvents:f=>u(a=>({...a,events:{...a.events,...f}})),setSize:(f,a,w=0,j=0)=>{const M=i().camera,g={width:f,height:a,top:w,left:j};u(k=>({size:g,viewport:{...k.viewport,...h(M,c,g)}}))},setDpr:f=>u(a=>{const w=at(f);return{viewport:{...a.viewport,dpr:w,initialDpr:a.viewport.initialDpr||w}}}),setFrameloop:(f="always")=>{const a=i().clock;a.stop(),a.elapsedTime=0,f!=="never"&&(a.start(),a.elapsedTime=0),u(()=>({frameloop:f}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:p.createRef(),active:!1,frames:0,priority:0,subscribe:(f,a,w)=>{const j=i().internal;return j.priority=j.priority+(a>0?1:0),j.subscribers.push({ref:f,priority:a,store:w}),j.subscribers=j.subscribers.sort((M,g)=>M.priority-g.priority),()=>{const M=i().internal;M!=null&&M.subscribers&&(M.priority=M.priority-(a>0?1:0),M.subscribers=M.subscribers.filter(g=>g.ref!==f))}}}}}),r=n.getState();let o=r.size,s=r.viewport.dpr,d=r.camera;return n.subscribe(()=>{const{camera:u,size:i,viewport:v,gl:c,set:l}=n.getState();if(i.width!==o.width||i.height!==o.height||v.dpr!==s){o=i,s=v.dpr,dn(u,i),v.dpr>0&&c.setPixelRatio(v.dpr);const h=typeof HTMLCanvasElement<"u"&&c.domElement instanceof HTMLCanvasElement;c.setSize(i.width,i.height,h)}u!==d&&(d=u,l(h=>({viewport:{...h.viewport,...h.viewport.getCurrentViewport(u)}})))}),n.subscribe(u=>e(u)),n};function dt(){const e=p.useContext(ft);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function mn(e=n=>n,t){return dt()(e,t)}function pt(e,t=0){const n=dt(),r=n.getState().internal.subscribe,o=ct(e);return fe(()=>r(o,t,n),[t,r,n]),null}function yn(e){const t=Jt(e);return t.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:p.version}),t}const vt=0,ie={},gn=/^three(?=[A-Z])/,je=e=>`${e[0].toUpperCase()}${e.slice(1)}`;let bn=0;const xn=e=>typeof e=="function";function wn(e){if(xn(e)){const t=`${bn++}`;return ie[t]=e,t}else Object.assign(ie,e)}function ht(e,t){const n=je(e),r=ie[n];if(e!=="primitive"&&!r)throw new Error(`R3F: ${n} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(e==="primitive"&&!t.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(t.args!==void 0&&!Array.isArray(t.args))throw new Error("R3F: The args prop must be an array!")}function jn(e,t,n){var r;return e=je(e)in ie?e:e.replace(gn,""),ht(e,t),e==="primitive"&&(r=t.object)!=null&&r.__r3f&&delete t.object.__r3f,ge(t.object,n,e,t)}function Mn(e){if(!e.isHidden){var t;e.props.attach&&(t=e.parent)!=null&&t.object?xe(e.parent,e):L(e.object)&&(e.object.visible=!1),e.isHidden=!0,se(e)}}function mt(e){if(e.isHidden){var t;e.props.attach&&(t=e.parent)!=null&&t.object?be(e.parent,e):L(e.object)&&e.props.visible!==!1&&(e.object.visible=!0),e.isHidden=!1,se(e)}}function Be(e,t,n){const r=t.root.getState();if(!(!e.parent&&e.object!==r.scene)){if(!t.object){var o,s;const d=ie[je(t.type)];t.object=(o=t.props.object)!=null?o:new d(...(s=t.props.args)!=null?s:[]),t.object.__r3f=t}if(Y(t.object,t.props),t.props.attach)be(e,t);else if(L(t.object)&&L(e.object)){const d=e.object.children.indexOf(n==null?void 0:n.object);if(n&&d!==-1){const u=e.object.children.indexOf(t.object);if(u!==-1){e.object.children.splice(u,1);const i=u<d?d-1:d;e.object.children.splice(i,0,t.object)}else t.object.parent=e.object,e.object.children.splice(d,0,t.object),t.object.dispatchEvent({type:"added"}),e.object.dispatchEvent({type:"childadded",child:t.object})}else e.object.add(t.object)}for(const d of t.children)Be(t,d);se(t)}}function Pe(e,t){t&&(t.parent=e,e.children.push(t),Be(e,t))}function Ke(e,t,n){if(!t||!n)return;t.parent=e;const r=e.children.indexOf(n);r!==-1?e.children.splice(r,0,t):e.children.push(t),Be(e,t,n)}function yt(e){if(typeof e.dispose=="function"){const t=()=>{try{e.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?t():$e.unstable_scheduleCallback($e.unstable_IdlePriority,t)}}function ze(e,t,n){if(!t)return;t.parent=null;const r=e.children.indexOf(t);r!==-1&&e.children.splice(r,1),t.props.attach?xe(e,t):L(t.object)&&L(e.object)&&(e.object.remove(t.object),pn(it(t),t.object));const o=t.props.dispose!==null&&n!==!1;for(let s=t.children.length-1;s>=0;s--){const d=t.children[s];ze(t,d,o)}t.children.length=0,delete t.object.__r3f,o&&t.type!=="primitive"&&t.object.type!=="Scene"&&yt(t.object),n===void 0&&se(t)}function Cn(e,t){for(const n of[e,e.alternate])if(n!==null)if(typeof n.ref=="function"){n.refCleanup==null||n.refCleanup();const r=n.ref(t);typeof r=="function"&&(n.refCleanup=r)}else n.ref&&(n.ref.current=t)}const ye=[];function Pn(){for(const[n]of ye){const r=n.parent;if(r){n.props.attach?xe(r,n):L(n.object)&&L(r.object)&&r.object.remove(n.object);for(const o of n.children)o.props.attach?xe(n,o):L(o.object)&&L(n.object)&&n.object.remove(o.object)}n.isHidden&&mt(n),n.object.__r3f&&delete n.object.__r3f,n.type!=="primitive"&&yt(n.object)}for(const[n,r,o]of ye){n.props=r;const s=n.parent;if(s){var e,t;const d=ie[je(n.type)];n.object=(e=n.props.object)!=null?e:new d(...(t=n.props.args)!=null?t:[]),n.object.__r3f=n,Cn(o,n.object),Y(n.object,n.props),n.props.attach?be(s,n):L(n.object)&&L(s.object)&&s.object.add(n.object);for(const u of n.children)u.props.attach?be(n,u):L(u.object)&&L(n.object)&&n.object.add(u.object);se(n)}}ye.length=0}const Se=()=>{},Qe={};let he=vt;const Sn=0,En=4,ke=yn({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:jn,removeChild:ze,appendChild:Pe,appendInitialChild:Pe,insertBefore:Ke,appendChildToContainer(e,t){const n=e.getState().scene.__r3f;!t||!n||Pe(n,t)},removeChildFromContainer(e,t){const n=e.getState().scene.__r3f;!t||!n||ze(n,t)},insertInContainerBefore(e,t,n){const r=e.getState().scene.__r3f;!t||!n||!r||Ke(r,t,n)},getRootHostContext:()=>Qe,getChildHostContext:()=>Qe,commitUpdate(e,t,n,r,o){var s,d,u;ht(t,r);let i=!1;if((e.type==="primitive"&&n.object!==r.object||((s=r.args)==null?void 0:s.length)!==((d=n.args)==null?void 0:d.length)||(u=r.args)!=null&&u.some((c,l)=>{var h;return c!==((h=n.args)==null?void 0:h[l])}))&&(i=!0),i)ye.push([e,{...r},o]);else{const c=ln(e,r);Object.keys(c).length&&(Object.assign(e.props,c),Y(e.object,c))}(o.sibling===null||(o.flags&En)===Sn)&&Pn()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:e=>e==null?void 0:e.object,prepareForCommit:()=>null,preparePortalMount:e=>ge(e.getState().scene,e,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:Mn,unhideInstance:mt,createTextInstance:Se,hideTextInstance:Se,unhideTextInstance:Se,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:p.createContext(null),setCurrentUpdatePriority(e){he=e},getCurrentUpdatePriority(){return he},resolveUpdatePriority(){var e;if(he!==vt)return he;switch(typeof window<"u"&&((e=window.event)==null?void 0:e.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return me.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return me.ContinuousEventPriority;default:return me.DefaultEventPriority}},resetFormInstance(){}}),ee=new Map,re={objects:"shallow",strict:!1};function Rn(e,t){if(!t&&typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:n,height:r,top:o,left:s}=e.parentElement.getBoundingClientRect();return{width:n,height:r,top:o,left:s}}else if(!t&&typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...t}}function On(e){const t=ee.get(e),n=t==null?void 0:t.fiber,r=t==null?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const o=typeof reportError=="function"?reportError:console.error,s=r||hn(Fe,tt),d=n||ke.createContainer(s,me.ConcurrentRoot,null,!1,null,"",o,o,o,null);t||ee.set(e,{fiber:d,store:s});let u,i,v=!1,c=null;return{async configure(l={}){let h;c=new Promise(C=>h=C);let{gl:m,size:O,scene:z,events:T,onCreated:f,shadows:a=!1,linear:w=!1,flat:j=!1,legacy:M=!1,orthographic:g=!1,frameloop:k="always",dpr:A=[1,2],performance:y,raycaster:S,camera:b,onPointerMissed:U}=l,x=s.getState(),_=x.gl;if(!x.gl){const C={canvas:e,powerPreference:"high-performance",antialias:!0,alpha:!0},P=typeof m=="function"?await m(C):m;Je(P)?_=P:_=new Ot({...C,...m}),x.set({gl:_})}let E=x.raycaster;E||x.set({raycaster:E=new Tt});const{params:X,...F}=S||{};if(I.equ(F,E,re)||Y(E,{...F}),I.equ(X,E.params,re)||Y(E,{params:{...E.params,...X}}),!x.camera||x.camera===i&&!I.equ(i,b,re)){i=b;const C=b==null?void 0:b.isCamera,P=C?b:g?new Le(0,0,0,0,.1,1e3):new We(75,0,.1,1e3);C||(P.position.z=5,b&&(Y(P,b),P.manual||("aspect"in b||"left"in b||"right"in b||"bottom"in b||"top"in b)&&(P.manual=!0,P.updateProjectionMatrix())),!x.camera&&!(b!=null&&b.rotation)&&P.lookAt(0,0,0)),x.set({camera:P}),E.camera=P}if(!x.scene){let C;z!=null&&z.isScene?(C=z,ge(C,s,"",{})):(C=new It,ge(C,s,"",{}),z&&Y(C,z)),x.set({scene:C})}T&&!x.events.handlers&&x.set({events:T(s)});const V=Rn(e,O);if(I.equ(V,x.size,re)||x.setSize(V.width,V.height,V.top,V.left),A&&x.viewport.dpr!==at(A)&&x.setDpr(A),x.frameloop!==k&&x.setFrameloop(k),x.onPointerMissed||x.set({onPointerMissed:U}),y&&!I.equ(y,x.performance,re)&&x.set(C=>({performance:{...C.performance,...y}})),!x.xr){var W;const C=(D,$)=>{const ce=s.getState();ce.frameloop!=="never"&&tt(D,!0,ce,$)},P=()=>{const D=s.getState();D.gl.xr.enabled=D.gl.xr.isPresenting,D.gl.xr.setAnimationLoop(D.gl.xr.isPresenting?C:null),D.gl.xr.isPresenting||Fe(D)},H={connect(){const D=s.getState().gl;D.xr.addEventListener("sessionstart",P),D.xr.addEventListener("sessionend",P)},disconnect(){const D=s.getState().gl;D.xr.removeEventListener("sessionstart",P),D.xr.removeEventListener("sessionend",P)}};typeof((W=_.xr)==null?void 0:W.addEventListener)=="function"&&H.connect(),x.set({xr:H})}if(_.shadowMap){const C=_.shadowMap.enabled,P=_.shadowMap.type;if(_.shadowMap.enabled=!!a,I.boo(a))_.shadowMap.type=Ce;else if(I.str(a)){var q;const H={basic:kt,percentage:zt,soft:Ce,variance:_t};_.shadowMap.type=(q=H[a])!=null?q:Ce}else I.obj(a)&&Object.assign(_.shadowMap,a);(C!==_.shadowMap.enabled||P!==_.shadowMap.type)&&(_.shadowMap.needsUpdate=!0)}return Bt.enabled=!M,v||(_.outputColorSpace=w?At:rt,_.toneMapping=j?Dt:Ft),x.legacy!==M&&x.set(()=>({legacy:M})),x.linear!==w&&x.set(()=>({linear:w})),x.flat!==j&&x.set(()=>({flat:j})),m&&!I.fun(m)&&!Je(m)&&!I.equ(m,_,re)&&Y(_,m),u=f,v=!0,h(),this},render(l){return!v&&!c&&this.configure(),c.then(()=>{ke.updateContainer(B.jsx(Tn,{store:s,children:l,onCreated:u,rootElement:e}),d,null,()=>{})}),s},unmount(){gt(e)}}}function Tn({store:e,children:t,onCreated:n,rootElement:r}){return fe(()=>{const o=e.getState();o.set(s=>({internal:{...s.internal,active:!0}})),n&&n(o),e.getState().events.connected||o.events.connect==null||o.events.connect(r)},[]),B.jsx(ft.Provider,{value:e,children:t})}function gt(e,t){const n=ee.get(e),r=n==null?void 0:n.fiber;if(r){const o=n==null?void 0:n.store.getState();o&&(o.internal.active=!1),ke.updateContainer(null,r,null,()=>{o&&setTimeout(()=>{try{var s,d,u,i;o.events.disconnect==null||o.events.disconnect(),(s=o.gl)==null||(d=s.renderLists)==null||d.dispose==null||d.dispose(),(u=o.gl)==null||u.forceContextLoss==null||u.forceContextLoss(),(i=o.gl)!=null&&i.xr&&o.xr.disconnect(),sn(o.scene),ee.delete(e)}catch{}},500)})}}const In=new Set,_n=new Set,zn=new Set;function Ee(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function le(e,t){switch(e){case"before":return Ee(In,t);case"after":return Ee(_n,t);case"tail":return Ee(zn,t)}}let Re,Oe;function Ae(e,t,n){let r=t.clock.getDelta();t.frameloop==="never"&&typeof e=="number"&&(r=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),Re=t.internal.subscribers;for(let o=0;o<Re.length;o++)Oe=Re[o],Oe.ref.current(Oe.store.getState(),r,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),t.frameloop==="always"?1:t.internal.frames}let we=!1,De=!1,Te,et,oe;function bt(e){et=requestAnimationFrame(bt),we=!0,Te=0,le("before",e),De=!0;for(const n of ee.values()){var t;oe=n.store.getState(),oe.internal.active&&(oe.frameloop==="always"||oe.internal.frames>0)&&!((t=oe.gl.xr)!=null&&t.isPresenting)&&(Te+=Ae(e,oe))}if(De=!1,le("after",e),Te===0)return le("tail",e),we=!1,cancelAnimationFrame(et)}function Fe(e,t=1){var n;if(!e)return ee.forEach(r=>Fe(r.store.getState(),t));(n=e.gl.xr)!=null&&n.isPresenting||!e.internal.active||e.frameloop==="never"||(t>1?e.internal.frames=Math.min(60,e.internal.frames+t):De?e.internal.frames=2:e.internal.frames=1,we||(we=!0,requestAnimationFrame(bt)))}function tt(e,t=!0,n,r){if(t&&le("before",e),n)Ae(e,n,r);else for(const o of ee.values())Ae(e,o.store.getState());t&&le("after",e)}const Ie={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function kn(e){const{handlePointer:t}=vn(e);return{priority:1,enabled:!0,compute(n,r,o){r.pointer.set(n.offsetX/r.size.width*2-1,-(n.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(Ie).reduce((n,r)=>({...n,[r]:t(r)}),{}),update:()=>{var n;const{events:r,internal:o}=e.getState();(n=o.lastEvent)!=null&&n.current&&r.handlers&&r.handlers.onPointerMove(o.lastEvent.current)},connect:n=>{const{set:r,events:o}=e.getState();if(o.disconnect==null||o.disconnect(),r(s=>({events:{...s.events,connected:n}})),o.handlers)for(const s in o.handlers){const d=o.handlers[s],[u,i]=Ie[s];n.addEventListener(u,d,{passive:i})}},disconnect:()=>{const{set:n,events:r}=e.getState();if(r.connected){if(r.handlers)for(const o in r.handlers){const s=r.handlers[o],[d]=Ie[o];r.connected.removeEventListener(d,s)}n(o=>({events:{...o.events,connected:void 0}}))}}}}function An({ref:e,children:t,fallback:n,resize:r,style:o,gl:s,events:d=kn,eventSource:u,eventPrefix:i,shadows:v,linear:c,flat:l,legacy:h,orthographic:m,frameloop:O,dpr:z,performance:T,raycaster:f,camera:a,scene:w,onPointerMissed:j,onCreated:M,...g}){p.useMemo(()=>wn(Vt),[]);const k=nn(),[A,y]=Gt({scroll:!0,debounce:{scroll:50,resize:0},...r}),S=p.useRef(null),b=p.useRef(null);p.useImperativeHandle(e,()=>S.current);const U=ct(j),[x,_]=p.useState(!1),[E,X]=p.useState(!1);if(x)throw x;if(E)throw E;const F=p.useRef(null);fe(()=>{const W=S.current;if(y.width>0&&y.height>0&&W){F.current||(F.current=On(W));async function q(){await F.current.configure({gl:s,scene:w,events:d,shadows:v,linear:c,flat:l,legacy:h,orthographic:m,frameloop:O,dpr:z,performance:T,raycaster:f,camera:a,size:y,onPointerMissed:(...C)=>U.current==null?void 0:U.current(...C),onCreated:C=>{C.events.connect==null||C.events.connect(u?en(u)?u.current:u:b.current),i&&C.setEvents({compute:(P,H)=>{const D=P[i+"X"],$=P[i+"Y"];H.pointer.set(D/H.size.width*2-1,-($/H.size.height)*2+1),H.raycaster.setFromCamera(H.pointer,H.camera)}}),M==null||M(C)}}),F.current.render(B.jsx(k,{children:B.jsx(on,{set:X,children:B.jsx(p.Suspense,{fallback:B.jsx(rn,{set:_}),children:t??null})})}))}q()}}),p.useEffect(()=>{const W=S.current;if(W)return()=>gt(W)},[]);const V=u?"none":"auto";return B.jsx("div",{ref:b,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:V,...o},...g,children:B.jsx("div",{ref:A,style:{width:"100%",height:"100%"},children:B.jsx("canvas",{ref:S,style:{display:"block"},children:n})})})}function or(e){return B.jsx(Zt,{children:B.jsx(An,{...e})})}const de=new Z,Ve=new Z,Dn=new Z,nt=new ot;function Fn(e,t,n){const r=de.setFromMatrixPosition(e.matrixWorld);r.project(t);const o=n.width/2,s=n.height/2;return[r.x*o+o,-(r.y*s)+s]}function Hn(e,t){const n=de.setFromMatrixPosition(e.matrixWorld),r=Ve.setFromMatrixPosition(t.matrixWorld),o=n.sub(r),s=t.getWorldDirection(Dn);return o.angleTo(s)>Math.PI/2}function Ln(e,t,n,r){const o=de.setFromMatrixPosition(e.matrixWorld),s=o.clone();s.project(t),nt.set(s.x,s.y),n.setFromCamera(nt,t);const d=n.intersectObjects(r,!0);if(d.length){const u=d[0].distance;return o.distanceTo(n.ray.origin)<u}return!0}function Wn(e,t){if(t instanceof Le)return t.zoom;if(t instanceof We){const n=de.setFromMatrixPosition(e.matrixWorld),r=Ve.setFromMatrixPosition(t.matrixWorld),o=t.fov*Math.PI/180,s=n.distanceTo(r);return 1/(2*Math.tan(o/2)*s)}else return 1}function Nn(e,t,n){if(t instanceof We||t instanceof Le){const r=de.setFromMatrixPosition(e.matrixWorld),o=Ve.setFromMatrixPosition(t.matrixWorld),s=r.distanceTo(o),d=(n[1]-n[0])/(t.far-t.near),u=n[1]-d*t.far;return Math.round(d*s+u)}}const He=e=>Math.abs(e)<1e-10?0:e;function xt(e,t,n=""){let r="matrix3d(";for(let o=0;o!==16;o++)r+=He(t[o]*e.elements[o])+(o!==15?",":")");return n+r}const Bn=(e=>t=>xt(t,e))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),Vn=(e=>(t,n)=>xt(t,e(n),"translate(-50%,-50%)"))(e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1]);function qn(e){return e&&typeof e=="object"&&"current"in e}const ir=p.forwardRef(({children:e,eps:t=.001,style:n,className:r,prepend:o,center:s,fullscreen:d,portal:u,distanceFactor:i,sprite:v=!1,transform:c=!1,occlude:l,onOcclude:h,castShadow:m,receiveShadow:O,material:z,geometry:T,zIndexRange:f=[16777271,0],calculatePosition:a=Fn,as:w="div",wrapperClass:j,pointerEvents:M="auto",...g},k)=>{const{gl:A,camera:y,scene:S,size:b,raycaster:U,events:x,viewport:_}=mn(),[E]=p.useState(()=>document.createElement(w)),X=p.useRef(null),F=p.useRef(null),V=p.useRef(0),W=p.useRef([0,0]),q=p.useRef(null),C=p.useRef(null),P=(u==null?void 0:u.current)||x.connected||A.domElement.parentNode,H=p.useRef(null),D=p.useRef(!1),$=p.useMemo(()=>l&&l!=="blending"||Array.isArray(l)&&l.length&&qn(l[0]),[l]);p.useLayoutEffect(()=>{const N=A.domElement;l&&l==="blending"?(N.style.zIndex=`${Math.floor(f[0]/2)}`,N.style.position="absolute",N.style.pointerEvents="none"):(N.style.zIndex=null,N.style.position=null,N.style.pointerEvents=null)},[l]),p.useLayoutEffect(()=>{if(F.current){const N=X.current=Kt.createRoot(E);if(S.updateMatrixWorld(),c)E.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const R=a(F.current,y,b);E.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${R[0]}px,${R[1]}px,0);transform-origin:0 0;`}return P&&(o?P.prepend(E):P.appendChild(E)),()=>{P&&P.removeChild(E),N.unmount()}}},[P,c]),p.useLayoutEffect(()=>{j&&(E.className=j)},[j]);const ce=p.useMemo(()=>c?{position:"absolute",top:0,left:0,width:b.width,height:b.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...d&&{top:-b.height/2,left:-b.width/2,width:b.width,height:b.height},...n},[n,s,d,b,c]),wt=p.useMemo(()=>({position:"absolute",pointerEvents:M}),[M]);p.useLayoutEffect(()=>{if(D.current=!1,c){var N;(N=X.current)==null||N.render(p.createElement("div",{ref:q,style:ce},p.createElement("div",{ref:C,style:wt},p.createElement("div",{ref:k,className:r,style:n,children:e}))))}else{var R;(R=X.current)==null||R.render(p.createElement("div",{ref:k,style:ce,className:r,children:e}))}});const te=p.useRef(!0);pt(N=>{if(F.current){y.updateMatrixWorld(),F.current.updateWorldMatrix(!0,!1);const R=c?W.current:a(F.current,y,b);if(c||Math.abs(V.current-y.zoom)>t||Math.abs(W.current[0]-R[0])>t||Math.abs(W.current[1]-R[1])>t){const J=Hn(F.current,y);let G=!1;$&&(Array.isArray(l)?G=l.map(K=>K.current):l!=="blending"&&(G=[S]));const ae=te.current;if(G){const K=Ln(F.current,y,U,G);te.current=K&&!J}else te.current=!J;ae!==te.current&&(h?h(!te.current):E.style.display=te.current?"block":"none");const pe=Math.floor(f[0]/2),jt=l?$?[f[0],pe]:[pe-1,0]:f;if(E.style.zIndex=`${Nn(F.current,y,jt)}`,c){const[K,Ue]=[b.width/2,b.height/2],Me=y.projectionMatrix.elements[5]*Ue,{isOrthographicCamera:Ge,top:Mt,left:Ct,bottom:Pt,right:St}=y,Et=Bn(y.matrixWorldInverse),Rt=Ge?`scale(${Me})translate(${He(-(St+Ct)/2)}px,${He((Mt+Pt)/2)}px)`:`translateZ(${Me}px)`;let Q=F.current.matrixWorld;v&&(Q=y.matrixWorldInverse.clone().transpose().copyPosition(Q).scale(F.current.scale),Q.elements[3]=Q.elements[7]=Q.elements[11]=0,Q.elements[15]=1),E.style.width=b.width+"px",E.style.height=b.height+"px",E.style.perspective=Ge?"":`${Me}px`,q.current&&C.current&&(q.current.style.transform=`${Rt}${Et}translate(${K}px,${Ue}px)`,C.current.style.transform=Vn(Q,1/((i||10)/400)))}else{const K=i===void 0?1:Wn(F.current,y)*i;E.style.transform=`translate3d(${R[0]}px,${R[1]}px,0) scale(${K})`}W.current=R,V.current=y.zoom}}if(!$&&H.current&&!D.current)if(c){if(q.current){const R=q.current.children[0];if(R!=null&&R.clientWidth&&R!=null&&R.clientHeight){const{isOrthographicCamera:J}=y;if(J||T)g.scale&&(Array.isArray(g.scale)?g.scale instanceof Z?H.current.scale.copy(g.scale.clone().divideScalar(1)):H.current.scale.set(1/g.scale[0],1/g.scale[1],1/g.scale[2]):H.current.scale.setScalar(1/g.scale));else{const G=(i||10)/400,ae=R.clientWidth*G,pe=R.clientHeight*G;H.current.scale.set(ae,pe,1)}D.current=!0}}}else{const R=E.children[0];if(R!=null&&R.clientWidth&&R!=null&&R.clientHeight){const J=1/_.factor,G=R.clientWidth*J,ae=R.clientHeight*J;H.current.scale.set(G,ae,1),D.current=!0}H.current.lookAt(N.camera.position)}});const qe=p.useMemo(()=>({vertexShader:c?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[c]);return p.createElement("group",Ne({},g,{ref:F}),l&&!$&&p.createElement("mesh",{castShadow:m,receiveShadow:O,ref:H},T||p.createElement("planeGeometry",null),z||p.createElement("shaderMaterial",{side:qt,vertexShader:qe.vertexShader,fragmentShader:qe.fragmentShader})))});var Un=`#define GLSLIFY 1
vec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 mod289(vec4 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}vec4 taylorInvSqrt(vec4 r){return 1.79284291400159-0.85373472095314*r;}float snoise(vec3 v){const vec2 C=vec2(1.0/6.0,1.0/3.0);const vec4 D=vec4(0.0,0.5,1.0,2.0);vec3 i=floor(v+dot(v,C.yyy));vec3 x0=v-i+dot(i,C.xxx);vec3 g=step(x0.yzx,x0.xyz);vec3 l=1.0-g;vec3 i1=min(g.xyz,l.zxy);vec3 i2=max(g.xyz,l.zxy);vec3 x1=x0-i1+C.xxx;vec3 x2=x0-i2+C.yyy;vec3 x3=x0-D.yyy;i=mod289(i);vec4 p=permute(permute(permute(i.z+vec4(0.0,i1.z,i2.z,1.0))+i.y+vec4(0.0,i1.y,i2.y,1.0))+i.x+vec4(0.0,i1.x,i2.x,1.0));float n_=0.142857142857;vec3 ns=n_*D.wyz-D.xzx;vec4 j=p-49.0*floor(p*ns.z*ns.z);vec4 x_=floor(j*ns.z);vec4 y_=floor(j-7.0*x_);vec4 x=x_*ns.x+ns.yyyy;vec4 y=y_*ns.x+ns.yyyy;vec4 h=1.0-abs(x)-abs(y);vec4 b0=vec4(x.xy,y.xy);vec4 b1=vec4(x.zw,y.zw);vec4 s0=floor(b0)*2.0+1.0;vec4 s1=floor(b1)*2.0+1.0;vec4 sh=-step(h,vec4(0.0));vec4 a0=b0.xzyw+s0.xzyw*sh.xxyy;vec4 a1=b1.xzyw+s1.xzyw*sh.zzww;vec3 p0=vec3(a0.xy,h.x);vec3 p1=vec3(a0.zw,h.y);vec3 p2=vec3(a1.xy,h.z);vec3 p3=vec3(a1.zw,h.w);vec4 norm=taylorInvSqrt(vec4(dot(p0,p0),dot(p1,p1),dot(p2,p2),dot(p3,p3)));p0*=norm.x;p1*=norm.y;p2*=norm.z;p3*=norm.w;vec4 m=max(0.6-vec4(dot(x0,x0),dot(x1,x1),dot(x2,x2),dot(x3,x3)),0.0);m=m*m;return 42.0*dot(m*m,vec4(dot(p0,x0),dot(p1,x1),dot(p2,x2),dot(p3,x3)));}`;class Gn extends Ut{constructor(t={}){super(t),this.setValues(t),this._time={value:0},this._distort={value:.4},this._radius={value:1}}onBeforeCompile(t){t.uniforms.time=this._time,t.uniforms.radius=this._radius,t.uniforms.distort=this._distort,t.vertexShader=`
      uniform float time;
      uniform float radius;
      uniform float distort;
      ${Un}
      ${t.vertexShader}
    `,t.vertexShader=t.vertexShader.replace("#include <begin_vertex>",`
        float updateTime = time / 50.0;
        float noise = snoise(vec3(position / 2.0 + updateTime * 5.0));
        vec3 transformed = vec3(position * (noise * pow(distort, 2.0) + radius));
        `)}get time(){return this._time.value}set time(t){this._time.value=t}get distort(){return this._distort.value}set distort(t){this._distort.value=t}get radius(){return this._radius.value}set radius(t){this._radius.value=t}}const sr=p.forwardRef(({speed:e=1,...t},n)=>{const[r]=p.useState(()=>new Gn);return pt(o=>r&&(r.time=o.clock.elapsedTime*e)),p.createElement("primitive",Ne({object:r,ref:n,attach:"material"},t))});function Xn(e,t){const n=e+"Geometry";return p.forwardRef(({args:r,children:o,...s},d)=>{const u=p.useRef(null);return p.useImperativeHandle(d,()=>u.current),p.useLayoutEffect(()=>void(t==null?void 0:t(u.current))),p.createElement("mesh",Ne({ref:u},s),p.createElement(n,{attach:"geometry",args:r}),o)})}const cr=Xn("sphere");export{or as C,ir as H,sr as M,cr as S,pt as u};
